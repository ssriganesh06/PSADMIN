SELECT * FROM PS_PROJECT WHERE PROJECT_ID BETWEEN '000000000000844' AND '000000000000911';

--Number of rows loaded
SELECT A.ANALYSIS_TYPE, A.BI_DISTRIB_STATUS,A.RESOURCE_SUB_CAT, SUM(A.RESOURCE_AMOUNT), COUNT(*) FROM PS_PROJ_RESOURCE A
WHERE A.PROJECT_ID BETWEEN '000000000000844' AND '000000000000911'
--AND A.ANALYSIS_TYPE IN ('BIL')
--AND A.ANALYSIS_TYPE NOT IN ('TLX','ACT')  
GROUP BY A.ANALYSIS_TYPE,A.BI_DISTRIB_STATUS,A.RESOURCE_SUB_CAT ;


SELECT A.PROJECT_ID, A.ACTIVITY_ID, B.ACTIVITY_USER3, C.OPT_PRJ_CRS_REFID, C.OPT_ACT_CRS_REFID, COUNT(*) 
FROM PS_PROJ_RESOURCE A, PS_PROJ_ACTIVITY B, PS_OPT_ACT_CRS_REF C
WHERE A.PROJECT_ID BETWEEN '000000000000844' AND '000000000000911'
AND A.PROJECT_ID = B.PROJECT_ID
AND A.ACTIVITY_ID = B.ACTIVITY_ID
AND A.PROJECT_ID = C.PROJECT_ID
AND A.ACTIVITY_ID = C.ACTIVITY_ID
AND A.ANALYSIS_TYPE IN ('TLX')
--AND A.ANALYSIS_TYPE NOT IN ('TLX','ACT')  
AND A.RESOURCE_SUB_CAT = 'NBILL'
--AND A.RESOURCE_SUB_CAT = 'X'
GROUP BY A.PROJECT_ID, A.ACTIVITY_ID, B.ACTIVITY_USER3, C.OPT_PRJ_CRS_REFID, C.OPT_ACT_CRS_REFID ;


SELECT A.PROJECT_ID, A.ANALYSIS_TYPE, A.BI_DISTRIB_STATUS, A.RESOURCE_TYPE, A.INVOICE, SUM(A.RESOURCE_AMOUNT), COUNT(*) FROM PS_PROJ_RESOURCE A
WHERE A.PROJECT_ID BETWEEN '000000000000844' AND '000000000000911'
--AND A.ANALYSIS_TYPE IN ('BIL')
--AND A.ANALYSIS_TYPE NOT IN ('TLX','ACT')  
GROUP BY A.PROJECT_ID, A.ANALYSIS_TYPE, A.BI_DISTRIB_STATUS, A.RESOURCE_TYPE, A.INVOICE ;

SELECT DISTINCT A.PROJECT_ID, A.ACTIVITY_ID FROM PS_PROJ_RESOURCE A LEFT OUTER JOIN PS_CA_DETAIL_PROJ B ON
A.PROJECT_ID = B.PROJECT_ID
AND A.ACTIVITY_ID = B.ACTIVITY_ID
WHERE A.PROJECT_ID BETWEEN '000000000000844' AND '000000000000911'
AND B.ACTIVITY_ID IS NULL ;

SELECT * FROM PS_OPT_PC_RT_EMPL 
WHERE PROJECT_ID BETWEEN '000000000000844' AND '000000000000911';

SELECT A.PROJECT_ID, A.ANALYSIS_TYPE, A.BI_DISTRIB_STATUS, A.RESOURCE_TYPE, A.INVOICE, SUM(A.RESOURCE_AMOUNT), COUNT(*) FROM PS_PROJ_RESOURCE A
WHERE A.PROJECT_ID BETWEEN '000000000000844' AND '000000000000911'
AND A.ANALYSIS_TYPE = 'TLX'
AND A.EMPLID NOT IN (SELECT B.EMPLID FROM PS_OPT_PC_RT_EMPL B
WHERE B.PROJECT_ID BETWEEN '000000000000844' AND '000000000000911'
AND A.PROJECT_ID = B.PROJECT_ID ) 
GROUP BY A.PROJECT_ID, A.ANALYSIS_TYPE, A.BI_DISTRIB_STATUS, A.RESOURCE_TYPE, A.INVOICE ;

SELECT A.PROJECT_ID, A.ACTIVITY_ID, A.ANALYSIS_TYPE, A.BI_DISTRIB_STATUS, A.RESOURCE_TYPE, A.INVOICE, SUM(A.RESOURCE_AMOUNT), COUNT(*) FROM PS_PROJ_RESOURCE A
WHERE A.PROJECT_ID BETWEEN '000000000000844' AND '000000000000911'
AND A.ANALYSIS_TYPE = 'TLX'
AND A.ACTIVITY_ID NOT IN (SELECT B.ACTIVITY_ID FROM PS_OPT_PC_RULE_ACT B
WHERE B.PROJECT_ID BETWEEN '000000000000844' AND '000000000000911'
AND A.PROJECT_ID = B.PROJECT_ID ) 
GROUP BY A.PROJECT_ID, A.ACTIVITY_ID, A.ANALYSIS_TYPE, A.BI_DISTRIB_STATUS, A.RESOURCE_TYPE, A.INVOICE ;


SELECT A.CONTRACT_NUM ,A.CONTRACT_LINE_NUM , A.OPTCA_PROPOSALID ,B.PROJECT_ID  FROM 
PS_OPT_CA_ADLN_TBL A , PS_PROJECT B 
WHERE B.BUSINESS_UNIT = 'PC001' 
AND B.PROJECT_ID BETWEEN '000000000000844' AND '000000000000911'
AND A.OPTCA_PROPOSALID = B.PROJECT_USER4 
ORDER BY B.PROJECT_ID , A.CONTRACT_NUM;

SELECT * FROM PS_OPT_PC_RULE_ACT 
WHERE PROJECT_ID BETWEEN '000000000000844' AND '000000000000911';

SELECT DISTINCT PROJECT_ID, ACTIVITY_ID FROM PS_CA_DETAIL_PROJ A
WHERE A.PROJECT_ID BETWEEN '000000000000844' AND '000000000000911' ;

SELECT DISTINCT PROJECT_ID, ACTIVITY_ID FROM PS_PROJ_RESOURCE A
WHERE A.PROJECT_ID BETWEEN '000000000000844' AND '000000000000911' ;

SELECT * FROM PS_PROJ_ACTIVITY
WHERE PROJECT_ID = '000000000000910' ;

SELECT * FROM PS_OPT_PRJ_CRS_REF 
WHERE PROJECT_ID BETWEEN '000000000000844' AND '000000000000911';

SELECT * FROM PS_OPT_ACT_CRS_REF 
WHERE PROJECT_ID BETWEEN '000000000000844' AND '000000000000911';

SELECT * FROM PS_OPT_PC_TXN_STG
WHERE PROJECT_ID BETWEEN '000000000000844' AND '000000000000911';