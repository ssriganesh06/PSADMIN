--SELECT EMPLID, TRANS_DT, RESOURCE_QUANTITY FROM PS_PROJ_RESOURCE
SELECT PROJECT_ID, TIME_SHEET_ID, EMPLID,TRANS_DT, RESOURCE_QUANTITY,BI_DISTRIB_STATUS FROM PS_PROJ_RESOURCE
WHERE ANALYSIS_TYPE = 'FTC'
--AND TIME_SHEET_ID = '109211' ;
AND PROJECT_ID IN ('010000000000228','010000000000254','000000000000127','010000000000256','010000000000265','010000000000527')
AND EMPLID = '000868551' 
ORDER BY 1;

SELECT * FROM PS_OPT_PRJ_CRS_REF 
WHERE OPT_PRJ_CRS_REFID = '63973' ;

SELECT DISTINCT PROJECT_ID FROM PS_INTFC_PROJ_RES ;

SELECT * FROM PS_INTFC_PROJ_RES ;
SELECT * FROM PS_PERSONAL_DATA

SELECT * FROM PS_PROJECT A 
WHERE A.PROJECT_ID IN ('010000000000228','010000000000254','000000000000127','010000000000256','010000000000265','010000000000527') ;

SELECT * FROM PS_OPT_PROJRES_REC  A
WHERE A.PROJECT_ID IN ('010000000000228','010000000000254','000000000000127','010000000000256','010000000000265','010000000000527')
AND OPT_SOURCE_SYS_ID = 'OA' 
AND OPT_ACT_CRS_REFID = 'PS_FORECAST' 
AND EXTRACT(month FROM ROW_LASTMANT_DTTM) = 3 ;


SELECT * FROM PS_OPT_INTFC_RES_R A
WHERE A.PROJECT_ID IN ('010000000000228','010000000000254','000000000000127','010000000000256','010000000000265','010000000000527')

SELECT A.ANALYSIS_TYPE, A.PROJECT_ID, A.ACTIVITY_ID, COUNT(*) FROM PS_PROJ_RESOURCE A
WHERE A.PROJECT_ID IN ('010000000000228','010000000000254','000000000000127','010000000000256','010000000000265','010000000000527')
--AND A.RESOURCE_AMOUNT = 0  
AND A.ACTIVITY_ID = 'EXPENSE'
GROUP BY A.ANALYSIS_TYPE, A.PROJECT_ID, A.ACTIVITY_ID ;

select * from ps_proj_resource where  project_id ='010000000000265' and ACTIVITY_ID= 'EXPENSE' AND emplid='000762092'


 SELECT *
  FROM PS_OPT_PC_RUN_REC



-- 632 hrs to 592 hrs
SELECT EMPLID,  SUM(RESOURCE_QUANTITY) , COUNT(*) FROM PS_PROJ_RESOURCE
WHERE ANALYSIS_TYPE = 'FTC'
AND TIME_SHEET_ID = '107037' 
GROUP BY EMPLID ; 


SELECT EMPLID, TIME_SHEET_ID,  COUNT(*) FROM PS_PROJ_RESOURCE
WHERE ANALYSIS_TYPE = 'FTC'
GROUP BY EMPLID, TIME_SHEET_ID
HAVING COUNT(*) > 1;

1. Movement of resources, Vasanth (10 rows, 80 hr) to Mark (12 rows, 96 hrs)
If Booking ID exists in PROJ_RESOURCE, 

    Delete FTC rows for the booking ID (632 hrs)
    Insert FTC rows from the file (592 hrs)
    
2. Updating hours for the same resource Vasanth (10 rows, 80 hr) to Vasanth (12 rows, 96 hrs)
If Booking ID exists in PROJ_RESOURCE, 

    Delete FTC rows for the booking ID (632 hrs)
    Insert FTC rows from the file (592 hrs)
    
    