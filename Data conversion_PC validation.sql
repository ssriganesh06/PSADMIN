SELECT PROJECT_ID, ANALYSIS_TYPE, CONTRACT_NUM, CONTRACT_LINE_NUM, COUNT(*) FROM PS_PROJ_RESOURCE
WHERE PROJECT_ID IN ('010000000000001','010000000000002')
GROUP BY PROJECT_ID, ANALYSIS_TYPE, CONTRACT_NUM, CONTRACT_LINE_NUM ;

--SELECT COUNT(*) FROM PS_PERSONAL_DATA 
SELECT * FROM PS_PERSONAL_DATA
WHERE EMPLID IN ('X19192','X20458');

SELECT * FROM PS_OPT_EMP_ADDINFO
WHERE DESCR = '24662' ;

SELECT * FROM PS_OPT_EMP_ADDINFO
WHERE DESCR IN ('24662','22355','827');


SELECT distinct value FROM PS_OPT_DC_PCLD_ERR 
where filename  = 'Timesheet_TLX_Iteration2_v1.csv'
WHERE PROCESS_INSTANCE = '88861' ;

SELECT * FROM PS_OPT_RP_EVENT
WHERE 

SELECT * FROM PS_OPT_PRJ_CRS_REF 
WHERE OPT_PRJ_CRS_REFID IN ('37782', '52387') ;

SELECT A.PROJECT_ID, A.OPT_PRJ_CRS_REFID, A.ACTIVITY_ID, A.OPT_ACT_CRS_REFID, B.TEAM_MEMBER, C.REFERENCE_NUM, C.PRODUCT_ID
FROM PS_OPT_ACT_CRS_REF A, PS_PROJECT_TEAM B, PS_OPT_PRJ_ADDINFO C
WHERE A.PROJECT_ID = B.PROJECT_ID 
AND A.PROJECT_ID = C.PROJECT_ID
--AND A.OPT_PRJ_CRS_REFID IN ('546780')
AND A.PROJECT_ID = '000000000000001' ;

SELECT A.ANALYSIS_TYPE, A.EMPLID, A.UNIT_OF_MEASURE, A.* FROM PS_PROJ_RESOURCE A
WHERE A.PROJECT_ID = '000000000000001' 
--AND A.ACTIVITY_ID = '000000000000001' 
AND A.TRANS_DT = '18-NOV-14' 
AND A.ANALYSIS_TYPE = 'TLX' ;
 

SELECT * FROM PS_PROJECT_TEAM
WHERE PROJECT_ID = '010000000000005' ;


SELECT * FROM PS_PROJ_ACTIVITY
WHERE PROJECT_ID IN ('010000000000001','010000000000002');

SELECT * FROM PS_PROJECT
WHERE PROJECT_ID IN ('010000000000001','010000000000002');

UPDATE PS_PROJECT SET PROJECT_USER4= 'DM090235'
WHERE PROJECT_ID = '010000000000002'; 

SELECT ANALYSIS_TYPE, ACTIVITY_ID, BI_DISTRIB_STATUS, PM_REVIEWED, CONTRACT_NUM, CONTRACT_LINE_NUM, BILLING_DATE, COUNT(*) FROM PS_PROJ_RESOURCE
WHERE PROJECT_ID = '010000000000079'
AND TRANS_DT BETWEEN '01-JAN-14' AND '12-SEP-14' 
GROUP BY ANALYSIS_TYPE, ACTIVITY_ID, BI_DISTRIB_STATUS, PM_REVIEWED, CONTRACT_NUM, CONTRACT_LINE_NUM, BILLING_DATE ;

SELECT ANALYSIS_TYPE, BI_DISTRIB_STATUS, PM_REVIEWED, CONTRACT_NUM, CONTRACT_LINE_NUM, BILLING_DATE, COUNT(*) FROM PS_PROJ_RESOURCE
WHERE PROJECT_ID = '010000000000079'
AND TRANS_DT BETWEEN '01-JAN-14' AND '12-SEP-14';

UPDATE PS_PROJ_RESOURCE SET BI_DISTRIB_STATUS = 'P', PROCESS_INSTANCE = 0
WHERE PROJECT_ID = '010000000000079'
--AND TRANS_DT BETWEEN '12-SEP-14' AND '12-DEC-18' 
AND ANALYSIS_TYPE IN ( 'BIL', 'TLX') 
AND BI_DISTRIB_STATUS = 'S' ;



SELECT ANALYSIS_TYPE, TRANS_DT FROM PS_PROJ_RESOURCE
WHERE PROJECT_ID = '010000000000079'
AND ANALYSIS_TYPE = 'BIL'
AND TRANS_DT BETWEEN =  
GROUP BY ANALYSIS_TYPE, BI_DISTRIB_STATUS, PM_REVIEWED, CONTRACT_NUM, CONTRACT_LINE_NUM, BILLING_DATE ;

UPDATE PS_PROJ_RESOURCE SET CONTRACT_NUM = 'PCINVTEMP', CONTRACT_LINE_NUM = 1
WHERE PROJECT_ID = '010000000000079';



-- Reference number and Product mapping
SELECT A.PRODUCT_ID, B.REFERENCE_NUM FROM PS_PROD_ITEM A,PS_OPT_PR_CREF_MST B 
WHERE A.SETID=B.SETID 
AND A.PRODUCT_ID=B.PRODUCT_ID 
AND A.SETID='OPTUM' 
AND B.REFERENCE_NUM IN (
'7712-773-001','28','3012-974-007','8112-532206-006','29','7612-773-008','7812-663-005','8112-511002-002','7012-513000-002',
'DC12-644-019','DC12-644-032','7812-515100-015') ;

--Department validation 
SELECT A.DEPTID, A.EFF_STATUS FROM PS_DEPT_TBL A 
WHERE A.SETID= 'OPTUM' 
AND A.EFFDT=(SELECT MAX(B.EFFDT) FROM PS_DEPT_TBL B WHERE B.SETID=A.SETID AND B.DEPTID=A.DEPTID AND B.EFFDT<=SYSDATE) 
AND A.EFF_STATUS = 'A'
AND A.DEPTID IN ( 
'835020','835021','834104','834103','818014','818010','839410','839412','839411','818012','839418','839408',
'839414','818013','839413','839415','818011') ;

-- Location validation
SELECT A.CHARTFIELD1 FROM PS_CHARTFIELD1_TBL A 
WHERE A.SETID='OPTUM' 
AND A.EFFDT=(SELECT MAX(B.EFFDT) FROM PS_CHARTFIELD1_TBL B WHERE B.SETID=A.SETID AND B.CHARTFIELD1=A.CHARTFIELD1 AND B.EFFDT<=SYSDATE) 
AND A.EFF_STATUS = 'A'
AND A.CHARTFIELD1 IN ('USAMN002'); 

-- Product validation
SELECT A.PRODUCT FROM PS_PRODUCT_TBL A 
WHERE A.SETID='OPTUM'
AND A.EFFDT=(SELECT MAX(B.EFFDT) FROM PS_PRODUCT_TBL B WHERE B.SETID=A.SETID AND B.PRODUCT=A.PRODUCT AND B.EFFDT<=SYSDATE) 
AND A.EFF_STATUS = 'A'
AND A.PRODUCT IN ('000000', '516014' ) ;

-- OU validation
SELECT A.OPERATING_UNIT FROM PS_OPER_UNIT_TBL A 
WHERE A.SETID='OPTUM' 
AND A.EFFDT=(SELECT MAX(B.EFFDT) FROM PS_OPER_UNIT_TBL B WHERE B.SETID=A.SETID AND B.OPERATING_UNIT=A.OPERATING_UNIT AND B.EFFDT<=SYSDATE) 
AND A.EFF_STATUS = 'A'
AND A.OPERATING_UNIT IN ('06222','08805'); 

-- Jobcode validation
SELECT A.JOBCODE FROM PS_JOBCODE_TBL A 
WHERE A.SETID='OPTUM'
AND A.EFF_STATUS='A'
AND A.JOBCODE IN ('0','SBI');

